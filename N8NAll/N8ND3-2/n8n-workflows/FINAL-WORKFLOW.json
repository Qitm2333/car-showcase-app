{
  "nodes": [
    {
      "parameters": {
        "jsCode": "// æå–å¹¶éªŒè¯å‚æ•°\nconst body = $input.item.json.body;\nconst action = body.action || 'add';\nconst userID = body.userID;\n\n// éªŒè¯å¿…å¡«å‚æ•°\nif (!userID) {\n  return {\n    json: {\n      success: false,\n      error: 'ç¼ºå°‘ç”¨æˆ·ID'\n    }\n  };\n}\n\n// ========== 1. åˆ›å»ºæ”¶è—å¤¹ ==========\nif (action === 'createFolder') {\n  const { folderName, folderIcon } = body;\n  \n  if (!folderName) {\n    return {\n      json: {\n        success: false,\n        error: 'ç¼ºå°‘æ”¶è—å¤¹åç§°'\n      }\n    };\n  }\n  \n  const folderID = 'folder_' + new Date().toISOString().slice(0,10).replace(/-/g,'') + '_' + Math.random().toString(36).substr(2, 9);\n  \n  return {\n    json: {\n      action: 'createFolder',\n      folderID: folderID,\n      userID: userID,\n      folderName: folderName,\n      folderIcon: folderIcon || 'ğŸ“',\n      createTime: new Date().toISOString(),\n      status: 'active'\n    }\n  };\n}\n\n// ========== 2. æŸ¥çœ‹æ”¶è—å¤¹åˆ—è¡¨ ==========\nif (action === 'listFolders') {\n  return {\n    json: {\n      action: 'listFolders',\n      userID: userID\n    }\n  };\n}\n\n// ========== 3. æ·»åŠ æ”¶è—ï¼ˆæ”¯æŒæŒ‡å®šæ–‡ä»¶å¤¹ï¼‰==========\nif (action === 'add') {\n  const { carID, carName, imageURL, folderID } = body;\n  \n  if (!carID || !carName || !imageURL) {\n    return {\n      json: {\n        success: false,\n        error: 'ç¼ºå°‘å¿…è¦å‚æ•°ï¼šcarID, carName æˆ– imageURL'\n      }\n    };\n  }\n  \n  const favoriteID = 'fav_' + new Date().toISOString().slice(0,10).replace(/-/g,'') + '_' + Math.random().toString(36).substr(2, 9);\n  \n  return {\n    json: {\n      action: 'add',\n      favoriteID: favoriteID,\n      userID: userID,\n      folderID: folderID || '', // å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™ä¸ºç©ºï¼ˆé»˜è®¤æ–‡ä»¶å¤¹ï¼‰\n      carID: carID,\n      carName: carName,\n      imageURL: imageURL,\n      favoriteTime: new Date().toISOString(),\n      status: 'active'\n    }\n  };\n}\n\n// ========== 4. æŸ¥çœ‹æ”¶è—åˆ—è¡¨ï¼ˆæ”¯æŒæŒ‰æ–‡ä»¶å¤¹ç­›é€‰ï¼‰==========\nif (action === 'list') {\n  return {\n    json: {\n      action: 'list',\n      userID: userID,\n      folderID: body.folderID || '' // å¯é€‰ï¼šç­›é€‰ç‰¹å®šæ–‡ä»¶å¤¹\n    }\n  };\n}\n\n// ========== 5. åˆ é™¤æ”¶è— ==========\nif (action === 'delete') {\n  const { favoriteID } = body;\n  \n  if (!favoriteID) {\n    return {\n      json: {\n        success: false,\n        error: 'ç¼ºå°‘ favoriteID'\n      }\n    };\n  }\n  \n  return {\n    json: {\n      action: 'delete',\n      userID: userID,\n      favoriteID: favoriteID\n    }\n  };\n}\n\n// ========== 6. åˆ é™¤æ”¶è—å¤¹ ==========\nif (action === 'deleteFolder') {\n  const { folderID } = body;\n  \n  if (!folderID) {\n    return {\n      json: {\n        success: false,\n        error: 'ç¼ºå°‘ folderID'\n      }\n    };\n  }\n  \n  return {\n    json: {\n      action: 'deleteFolder',\n      userID: userID,\n      folderID: folderID\n    }\n  };\n}\n\nreturn {\n  json: {\n    success: false,\n    error: 'æœªçŸ¥æ“ä½œç±»å‹: ' + action\n  }\n};"
      },
      "id": "d6a08011-4ed4-4379-a151-c2b861598350",
      "name": "å¤„ç†å‚æ•°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3760,
        5296
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ",
          "mode": "list",
          "cachedResultName": "CarSheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 328604113,
          "mode": "list",
          "cachedResultName": "FavoriteFolders",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit#gid=328604113"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "folderID": "={{ $json.folderID }}",
            "userID": "={{ $json.userID }}",
            "folderName": "={{ $json.folderName }}",
            "folderIcon": "={{ $json.folderIcon }}",
            "createTime": "={{ $json.createTime }}",
            "status": "={{ $json.status }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "folderID",
              "displayName": "folderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "userID",
              "displayName": "userID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "folderName",
              "displayName": "folderName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "folderIcon",
              "displayName": "folderIcon",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "createTime",
              "displayName": "createTime",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "64575e3e-9204-42a9-9793-648fdd918808",
      "name": "ä¿å­˜æ”¶è—å¤¹",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4192,
        4928
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YS5a72jpKHezwxcc",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ",
          "mode": "list",
          "cachedResultName": "CarSheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 328604113,
          "mode": "list",
          "cachedResultName": "FavoriteFolders",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit#gid=328604113"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "userID",
              "lookupValue": "={{ $json.userID }}"
            },
            {
              "lookupColumn": "status",
              "lookupValue": "active"
            }
          ]
        },
        "options": {}
      },
      "id": "d9f9cb26-d3f5-45ee-998e-fbdfcc0f2da5",
      "name": "è¯»å–æ”¶è—å¤¹",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4192,
        5088
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YS5a72jpKHezwxcc",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ",
          "mode": "list",
          "cachedResultName": "CarSheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1274046316,
          "mode": "list",
          "cachedResultName": "Favorites",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit#gid=1274046316"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "favoriteID": "={{ $json.favoriteID }}",
            "userID": "={{ $json.userID }}",
            "folderID": "={{ $json.folderID }}",
            "carID": "={{ $json.carID }}",
            "carName": "={{ $json.carName }}",
            "imageURL": "={{ $json.imageURL }}",
            "favoriteTime": "={{ $json.favoriteTime }}",
            "status": "={{ $json.status }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "favoriteID",
              "displayName": "favoriteID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "userID",
              "displayName": "userID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "folderID",
              "displayName": "folderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "carID",
              "displayName": "carID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "carName",
              "displayName": "carName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "imageURL",
              "displayName": "imageURL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "favoriteTime",
              "displayName": "favoriteTime",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "0799e822-28c1-4d19-b673-9eb32d177026",
      "name": "ä¿å­˜æ”¶è—",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4192,
        5248
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YS5a72jpKHezwxcc",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ",
          "mode": "list",
          "cachedResultName": "CarSheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1274046316,
          "mode": "list",
          "cachedResultName": "Favorites",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit#gid=1274046316"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "userID",
              "lookupValue": "={{ $json.userID }}"
            },
            {
              "lookupColumn": "status",
              "lookupValue": "active"
            }
          ]
        },
        "options": {}
      },
      "id": "1ea294d4-fe4f-45a1-a483-668cacd38c3f",
      "name": "è¯»å–æ”¶è—",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4192,
        5408
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YS5a72jpKHezwxcc",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ",
          "mode": "list",
          "cachedResultName": "CarSheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1274046316,
          "mode": "list",
          "cachedResultName": "Favorites",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit#gid=1274046316"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "favoriteID",
              "lookupValue": "={{ $json.favoriteID }}"
            },
            {
              "lookupColumn": "userID",
              "lookupValue": "={{ $json.userID }}"
            }
          ]
        },
        "options": {}
      },
      "id": "e6bef3a2-a8fa-42a5-ba4d-15136d06c65c",
      "name": "æŸ¥æ‰¾è¦åˆ é™¤çš„æ”¶è—",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4192,
        5568
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YS5a72jpKHezwxcc",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ",
          "mode": "list",
          "cachedResultName": "CarSheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 328604113,
          "mode": "list",
          "cachedResultName": "FavoriteFolders",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit#gid=328604113"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "folderID",
              "lookupValue": "={{ $json.folderID }}"
            },
            {
              "lookupColumn": "userID",
              "lookupValue": "={{ $json.userID }}"
            }
          ]
        },
        "options": {}
      },
      "id": "c2369308-58fc-4411-8937-05f50bb843dc",
      "name": "æŸ¥æ‰¾è¦åˆ é™¤çš„æ”¶è—å¤¹",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4192,
        5728
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YS5a72jpKHezwxcc",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ",
          "mode": "list",
          "cachedResultName": "CarSheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1274046316,
          "mode": "list",
          "cachedResultName": "Favorites",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit#gid=1274046316"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "status": "deleted"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "favoriteID",
              "displayName": "favoriteID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "userID",
              "displayName": "userID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "folderID",
              "displayName": "folderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "carID",
              "displayName": "carID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "carName",
              "displayName": "carName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "imageURL",
              "displayName": "imageURL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "favoriteTime",
              "displayName": "favoriteTime",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "b0e0f69a-8cd8-4343-9bd0-069cbf52d097",
      "name": "æ ‡è®°æ”¶è—ä¸ºåˆ é™¤",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4400,
        5568
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YS5a72jpKHezwxcc",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ",
          "mode": "list",
          "cachedResultName": "CarSheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 328604113,
          "mode": "list",
          "cachedResultName": "FavoriteFolders",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mjs9hbxuETgarWLqKlHxhK3XQHKG2E6BmkpMs6RUghQ/edit#gid=328604113"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "status": "deleted",
            "row_number": "={{ $json.row_number }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "folderID",
              "displayName": "folderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "userID",
              "displayName": "userID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "folderName",
              "displayName": "folderName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "folderIcon",
              "displayName": "folderIcon",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "createTime",
              "displayName": "createTime",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "ae68cc3d-2a00-4a8a-93f6-2375d291929a",
      "name": "æ ‡è®°æ”¶è—å¤¹ä¸ºåˆ é™¤",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4400,
        5728
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YS5a72jpKHezwxcc",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\nreturn {\n  json: {\n    success: true,\n    message: 'æ”¶è—å¤¹åˆ›å»ºæˆåŠŸ',\n    data: {\n      folderID: data.folderID,\n      folderName: data.folderName,\n      folderIcon: data.folderIcon\n    }\n  }\n};"
      },
      "id": "d7a398d3-95e1-444d-9a34-ddd9de021687",
      "name": "åˆ›å»ºæ”¶è—å¤¹æˆåŠŸ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4400,
        4928
      ]
    },
    {
      "parameters": {
        "jsCode": "// æ”¶è—å¤¹åˆ—è¡¨å“åº”\nconst items = $input.all();\n\n// æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆæ•°æ®\nconst hasData = items && items.length > 0 && items[0].json && Object.keys(items[0].json).length > 0;\n\nif (!hasData) {\n  // çœŸæ­£çš„ç©ºæ•°æ®ï¼šè¿”å›ç©ºåˆ—è¡¨\n  return {\n    json: {\n      success: true,\n      message: 'æš‚æ— æ”¶è—å¤¹',\n      total: 0,\n      folders: []\n    }\n  };\n}\n\n// æœ‰æ•°æ®æ—¶çš„å¤„ç†\nconst folders = items.map(item => ({\n  folderID: item.json.folderID || '',\n  folderName: item.json.folderName || '',\n  folderIcon: item.json.folderIcon || 'ğŸ“',\n  createTime: item.json.createTime || ''\n}));\n\nreturn {\n  json: {\n    success: true,\n    message: `æ‰¾åˆ°${folders.length}ä¸ªæ”¶è—å¤¹`,\n    total: folders.length,\n    folders: folders\n  }\n};"
      },
      "id": "d2d17f80-3829-456b-941b-2f91e548f4af",
      "name": "æ”¶è—å¤¹åˆ—è¡¨å“åº”",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4400,
        5088
      ],
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\n// æ„å»ºè¿”å›æ•°æ®ï¼Œç¡®ä¿ folderID æ­£ç¡®å¤„ç†\nconst result = {\n  json: {\n    success: true,\n    message: 'æ”¶è—æˆåŠŸ',\n    data: {\n      favoriteID: data.favoriteID,\n      carName: data.carName,\n      timestamp: data.favoriteTime\n    }\n  }\n};\n\n// åªæœ‰å½“ folderID å­˜åœ¨ä¸”ä¸ä¸ºç©ºæ—¶æ‰æ·»åŠ åˆ°è¿”å›æ•°æ®\nif (data.folderID && data.folderID !== '') {\n  result.json.data.folderID = data.folderID;\n}\n\nreturn result;"
      },
      "id": "0886b9f0-67c8-49f1-8b59-4127af0b985e",
      "name": "æ·»åŠ æ”¶è—æˆåŠŸ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4400,
        5248
      ]
    },
    {
      "parameters": {
        "jsCode": "// æŸ¥çœ‹åˆ—è¡¨å“åº”ï¼ˆæ”¯æŒæŒ‰ folderID ç­›é€‰ï¼‰\nconst items = $input.all();\n\n// æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆæ•°æ®\nconst hasData = items && items.length > 0 && items[0].json && Object.keys(items[0].json).length > 0;\n\nif (!hasData) {\n  // çœŸæ­£çš„ç©ºæ•°æ®ï¼šè¿”å›ç©ºåˆ—è¡¨\n  return {\n    json: {\n      success: true,\n      message: 'æš‚æ— æ”¶è—',\n      total: 0,\n      favorites: []\n    }\n  };\n}\n\n// ğŸ¯ è·å–è¦ç­›é€‰çš„ folderIDï¼ˆä»å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼‰\nconst requestedFolderID = $('å¤„ç†å‚æ•°').first().json.folderID;\n\nconsole.log('ğŸ” è¯·æ±‚çš„ folderID:', requestedFolderID);\n\n// ğŸ¯ æ ¹æ® folderID ç­›é€‰æ•°æ®\nlet filteredItems = items;\n\nif (requestedFolderID && requestedFolderID !== '') {\n  // å¦‚æœæŒ‡å®šäº† folderIDï¼Œåªè¿”å›è¯¥æ–‡ä»¶å¤¹çš„æ”¶è—\n  filteredItems = items.filter(item => {\n    const itemFolderID = item.json.folderID || '';\n    return itemFolderID === requestedFolderID;\n  });\n  console.log(`âœ… æŒ‰ folderID ç­›é€‰: ${requestedFolderID}, æ‰¾åˆ° ${filteredItems.length} é¡¹`);\n} else {\n  // å¦‚æœæ²¡æœ‰æŒ‡å®š folderIDï¼Œè¿”å›æ‰€æœ‰æ”¶è—\n  console.log(`âœ… è¿”å›æ‰€æœ‰æ”¶è—: ${filteredItems.length} é¡¹`);\n}\n\n// è½¬æ¢ä¸ºå‰ç«¯éœ€è¦çš„æ ¼å¼\nconst favorites = filteredItems.map(item => ({\n  favoriteID: item.json.favoriteID || '',\n  folderID: item.json.folderID || '',\n  carID: item.json.carID || '',\n  carName: item.json.carName || '',\n  imageURL: item.json.imageURL || '',\n  favoriteTime: item.json.favoriteTime || ''\n}));\n\nreturn {\n  json: {\n    success: true,\n    message: `æ‰¾åˆ°${favorites.length}ä¸ªæ”¶è—`,\n    total: favorites.length,\n    favorites: favorites\n  }\n};"
      },
      "id": "cbf28904-db0c-451a-be40-7e73cb85699d",
      "name": "æ”¶è—åˆ—è¡¨å“åº”",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4400,
        5408
      ]
    },
    {
      "parameters": {
        "jsCode": "return {\n  json: {\n    success: true,\n    message: 'å·²å–æ¶ˆæ”¶è—'\n  }\n};"
      },
      "id": "9a0de830-0dd9-4631-8ede-05f373bef228",
      "name": "åˆ é™¤æ”¶è—æˆåŠŸ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4592,
        5568
      ]
    },
    {
      "parameters": {
        "jsCode": "return {\n  json: {\n    success: true,\n    message: 'æ”¶è—å¤¹å·²åˆ é™¤'\n  }\n};"
      },
      "id": "b4b42ffd-76ee-4d8f-8288-1d2393446279",
      "name": "åˆ é™¤æ”¶è—å¤¹æˆåŠŸ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4592,
        5728
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "user-favorite",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "b8e2b7a3-e42b-49cc-ba9f-79dcd80c16d1",
      "name": "æ”¶è—å…¥å£1",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        3536,
        5296
      ],
      "webhookId": "user-favorite"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "createFolder",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "åˆ›å»ºæ”¶è—å¤¹"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "listFolders",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "æŸ¥çœ‹æ”¶è—å¤¹"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "add",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "æ·»åŠ æ”¶è—"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "list",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "æŸ¥çœ‹æ”¶è—"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "delete",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "åˆ é™¤æ”¶è—"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "deleteFolder",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "åˆ é™¤æ”¶è—å¤¹"
            }
          ]
        },
        "options": {}
      },
      "id": "5895ab7c-84a2-47a7-9a9f-978c4ae92d69",
      "name": "é€‰æ‹©æ“ä½œ1",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        4000,
        5232
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "a54d396b-7c85-4fb3-83cc-466389fefb2a",
      "name": "è¿”å›ç»“æœ2",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        4800,
        5232
      ]
    }
  ],
  "connections": {
    "å¤„ç†å‚æ•°": {
      "main": [
        [
          {
            "node": "é€‰æ‹©æ“ä½œ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¿å­˜æ”¶è—å¤¹": {
      "main": [
        [
          {
            "node": "åˆ›å»ºæ”¶è—å¤¹æˆåŠŸ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–æ”¶è—å¤¹": {
      "main": [
        [
          {
            "node": "æ”¶è—å¤¹åˆ—è¡¨å“åº”",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¿å­˜æ”¶è—": {
      "main": [
        [
          {
            "node": "æ·»åŠ æ”¶è—æˆåŠŸ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–æ”¶è—": {
      "main": [
        [
          {
            "node": "æ”¶è—åˆ—è¡¨å“åº”",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥æ‰¾è¦åˆ é™¤çš„æ”¶è—": {
      "main": [
        [
          {
            "node": "æ ‡è®°æ”¶è—ä¸ºåˆ é™¤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥æ‰¾è¦åˆ é™¤çš„æ”¶è—å¤¹": {
      "main": [
        [
          {
            "node": "æ ‡è®°æ”¶è—å¤¹ä¸ºåˆ é™¤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ‡è®°æ”¶è—ä¸ºåˆ é™¤": {
      "main": [
        [
          {
            "node": "åˆ é™¤æ”¶è—æˆåŠŸ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ‡è®°æ”¶è—å¤¹ä¸ºåˆ é™¤": {
      "main": [
        [
          {
            "node": "åˆ é™¤æ”¶è—å¤¹æˆåŠŸ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ›å»ºæ”¶è—å¤¹æˆåŠŸ": {
      "main": [
        [
          {
            "node": "è¿”å›ç»“æœ2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ”¶è—å¤¹åˆ—è¡¨å“åº”": {
      "main": [
        [
          {
            "node": "è¿”å›ç»“æœ2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ·»åŠ æ”¶è—æˆåŠŸ": {
      "main": [
        [
          {
            "node": "è¿”å›ç»“æœ2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ”¶è—åˆ—è¡¨å“åº”": {
      "main": [
        [
          {
            "node": "è¿”å›ç»“æœ2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ é™¤æ”¶è—æˆåŠŸ": {
      "main": [
        [
          {
            "node": "è¿”å›ç»“æœ2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ é™¤æ”¶è—å¤¹æˆåŠŸ": {
      "main": [
        [
          {
            "node": "è¿”å›ç»“æœ2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ”¶è—å…¥å£1": {
      "main": [
        [
          {
            "node": "å¤„ç†å‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é€‰æ‹©æ“ä½œ1": {
      "main": [
        [
          {
            "node": "ä¿å­˜æ”¶è—å¤¹",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è¯»å–æ”¶è—å¤¹",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ä¿å­˜æ”¶è—",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è¯»å–æ”¶è—",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æŸ¥æ‰¾è¦åˆ é™¤çš„æ”¶è—",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æŸ¥æ‰¾è¦åˆ é™¤çš„æ”¶è—å¤¹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "5cb72472896fce0666bc03ef84936c4f09ec11e6b4f95f9aebe3d538947c7935"
  }
}