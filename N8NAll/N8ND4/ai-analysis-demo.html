<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIè½¦å‹åˆ†æåŠ©æ‰‹ - è°ƒè¯•ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', sans-serif;
            background: #f5f5f5;
            height: 100vh;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* å·¦ä¾§å†å²è®°å½• */
        .sidebar {
            width: 250px;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            font-weight: 600;
        }

        .history-title {
            padding: 16px 20px;
            font-size: 12px;
            color: #999;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .history-list {
            flex: 1;
            overflow-y: auto;
            padding: 0 12px;
        }

        .history-item {
            padding: 12px;
            margin-bottom: 4px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .history-item:hover {
            background: #f3f4f6;
        }

        .history-item.active {
            background: #eef2ff;
        }

        .history-item-title {
            font-size: 14px;
            color: #333;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .history-item-tags {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .mini-tag {
            font-size: 10px;
            padding: 2px 6px;
            background: #e0e7ff;
            color: #4f46e5;
            border-radius: 4px;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #fafafa;
        }

        .main-header {
            background: white;
            padding: 20px 40px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .main-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .new-dialogue-btn {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .new-dialogue-btn:hover {
            background: #5568d3;
        }

        /* å¯¹è¯åŒºåŸŸ */
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .message {
            display: flex;
            gap: 12px;
            max-width: 800px;
        }

        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .message.assistant .message-avatar {
            background: #f3f4f6;
            color: #666;
        }

        .message-content {
            background: white;
            padding: 16px 20px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            max-width: 600px;
        }

        .message.user .message-content {
            background: #667eea;
            color: white;
        }

        .message-text {
            font-size: 14px;
            line-height: 1.6;
        }

        .message-actions {
            margin-top: 12px;
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 16px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            border: 1px solid #e5e7eb;
            background: white;
            transition: all 0.2s;
        }

        .action-btn.accept {
            background: #10b981;
            color: white;
            border-color: #10b981;
        }

        .action-btn.accept:hover {
            background: #059669;
        }

        .action-btn.reject {
            color: #666;
        }

        .action-btn.reject:hover {
            background: #f3f4f6;
        }

        /* æŠ¥å‘Šå¡ç‰‡ */
        .report-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            max-width: 800px;
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .report-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .report-time {
            font-size: 12px;
            color: #999;
        }

        .download-btn {
            padding: 8px 16px;
            background: #f3f4f6;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            color: #666;
            transition: background 0.2s;
        }

        .download-btn:hover {
            background: #e5e7eb;
        }

        /* è¾“å…¥åŒºåŸŸ */
        .input-container {
            background: white;
            border-top: 1px solid #e5e7eb;
            padding: 20px 40px;
        }

        .tag-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .tag-btn {
            padding: 6px 16px;
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 16px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            color: #666;
        }

        .tag-btn.active {
            background: #e0e7ff;
            color: #4f46e5;
            border-color: #c7d2fe;
        }

        .tag-btn .remove {
            margin-left: 6px;
            font-weight: 600;
        }

        .input-wrapper {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .message-input {
            flex: 1;
            padding: 12px 20px;
            border: 1px solid #e5e7eb;
            border-radius: 24px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s;
        }

        .message-input:focus {
            border-color: #667eea;
        }

        .send-btn {
            width: 44px;
            height: 44px;
            background: #667eea;
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: background 0.2s;
        }

        .send-btn:hover {
            background: #5568d3;
        }

        .send-btn:disabled {
            background: #e5e7eb;
            cursor: not-allowed;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            gap: 4px;
            padding: 8px 0;
        }

        .loading-dot {
            width: 8px;
            height: 8px;
            background: #999;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* è°ƒè¯•é¢æ¿ */
        .debug-panel {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #1f2937;
            color: #e5e7eb;
            padding: 16px;
            border-radius: 8px;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            max-width: 400px;
            max-height: 300px;
            overflow-y: auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .debug-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #10b981;
        }

        .debug-url {
            background: #374151;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 12px;
            word-break: break-all;
        }

        .debug-log {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #374151;
        }

        .debug-log-item {
            margin-bottom: 4px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- å·¦ä¾§å†å²è®°å½• -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="user-info">
                    <div class="user-avatar">ç‹</div>
                    <div>
                        <div style="font-weight: 600; font-size: 14px;">ç‹å…ˆç”Ÿ</div>
                        <div style="font-size: 12px; color: #999;">testCode</div>
                    </div>
                </div>
            </div>
            <div class="history-title">å†å²åˆ†æ</div>
            <div class="history-list" id="historyList">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-content">
            <div class="main-header">
                <div class="main-title" id="dialogueTitle">æ–°å¯¹è¯</div>
                <button class="new-dialogue-btn" onclick="startNewDialogue()">
                    <span>+</span>
                    <span>æ–°å¯¹è¯</span>
                </button>
            </div>

            <div class="chat-container" id="chatContainer">
                <!-- æ¬¢è¿æ¶ˆæ¯ -->
                <div class="message assistant">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        <div class="message-text">
                            ğŸ‘‹ ä½ å¥½ï¼æˆ‘æ˜¯AIè½¦å‹åˆ†æåŠ©æ‰‹ã€‚<br><br>
                            ä½ å¯ä»¥å‘Šè¯‰æˆ‘ä½ å…³å¿ƒçš„å¯¹æ¯”ç»´åº¦ï¼ˆå¦‚å¤–è§‚ã€å†…é¥°ã€ç»­èˆªç­‰ï¼‰ï¼Œæˆ‘ä¼šå¸®ä½ ç”Ÿæˆä¸“ä¸šçš„å¯¹æ¯”æŠ¥å‘Šã€‚
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-container">
                <div class="tag-selector" id="tagSelector">
                    <button class="tag-btn" data-tag="å¤–è§‚" onclick="toggleTag(this)">å¤–è§‚</button>
                    <button class="tag-btn" data-tag="å†…é¥°" onclick="toggleTag(this)">å†…é¥°</button>
                    <button class="tag-btn" data-tag="æ€§èƒ½" onclick="toggleTag(this)">æ€§èƒ½</button>
                    <button class="tag-btn" data-tag="ç»­èˆª" onclick="toggleTag(this)">ç»­èˆª</button>
                    <button class="tag-btn" data-tag="ç©ºé—´" onclick="toggleTag(this)">ç©ºé—´</button>
                    <button class="tag-btn" data-tag="é…ç½®" onclick="toggleTag(this)">é…ç½®</button>
                    <button class="tag-btn" data-tag="æ™ºèƒ½åŒ–" onclick="toggleTag(this)">æ™ºèƒ½åŒ–</button>
                </div>
                <div class="input-wrapper">
                    <input 
                        type="text" 
                        class="message-input" 
                        id="messageInput" 
                        placeholder="Ask me something..."
                        onkeypress="handleKeyPress(event)"
                    >
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">â–²</button>
                </div>
            </div>
        </div>
    </div>

    <!-- è°ƒè¯•é¢æ¿ -->
    <div class="debug-panel">
        <div class="debug-title">ğŸ”§ è°ƒè¯•é¢æ¿</div>
        <div class="debug-url" id="webhookUrl">
            Webhook URL: è®¾ç½®åæ˜¾ç¤º
        </div>
        <label style="display: block; margin-bottom: 8px;">
            è®¾ç½®Webhook URL:
            <input 
                type="text" 
                id="webhookInput" 
                placeholder="https://your-n8n.com/webhook/ai-analysis"
                style="width: 100%; padding: 4px; margin-top: 4px; background: #374151; border: 1px solid #4b5563; color: white; border-radius: 4px;"
                onchange="updateWebhookUrl()"
            >
        </label>
        <div class="debug-log" id="debugLog">
            <div>ç­‰å¾…æ“ä½œ...</div>
        </div>
    </div>

    <script>
        // ===== é…ç½® =====
        let WEBHOOK_URL = '';
        const USER_ID = 'testCode'; // æµ‹è¯•ç”¨æˆ·ID
        let currentDialogueID = null;
        let selectedTags = [];
        let dialogueHistory = [];

        // ===== åˆå§‹åŒ– =====
        function init() {
            // ä»localStorageè¯»å–é…ç½®
            const savedUrl = localStorage.getItem('webhookUrl');
            if (savedUrl) {
                WEBHOOK_URL = savedUrl;
                document.getElementById('webhookInput').value = savedUrl;
                document.getElementById('webhookUrl').textContent = 'Webhook URL: ' + savedUrl;
            }
            
            // åŠ è½½å†å²å¯¹è¯
            loadDialogueList();
        }

        // ===== æ›´æ–°Webhook URL =====
        function updateWebhookUrl() {
            const input = document.getElementById('webhookInput');
            WEBHOOK_URL = input.value;
            localStorage.setItem('webhookUrl', WEBHOOK_URL);
            document.getElementById('webhookUrl').textContent = 'Webhook URL: ' + WEBHOOK_URL;
            addDebugLog('âœ… Webhook URLå·²æ›´æ–°');
        }

        // ===== æ ‡ç­¾ç®¡ç† =====
        function toggleTag(btn) {
            const tag = btn.dataset.tag;
            if (btn.classList.contains('active')) {
                btn.classList.remove('active');
                selectedTags = selectedTags.filter(t => t !== tag);
                btn.innerHTML = tag;
            } else {
                btn.classList.add('active');
                selectedTags.push(tag);
                btn.innerHTML = tag + ' <span class="remove">Ã—</span>';
            }
            addDebugLog(`æ ‡ç­¾åˆ‡æ¢: ${selectedTags.join(', ')}`);
        }

        // ===== å‘é€æ¶ˆæ¯ =====
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const content = input.value.trim();
            
            if (!content) return;
            if (!WEBHOOK_URL) {
                alert('è¯·å…ˆè®¾ç½®Webhook URLï¼');
                return;
            }

            // ç¦ç”¨è¾“å…¥
            input.disabled = true;
            document.getElementById('sendBtn').disabled = true;

            // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
            addMessage('user', content);
            input.value = '';

            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            const loadingId = addLoadingMessage();

            try {
                // è°ƒç”¨N8N Webhook
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'sendMessage',
                        userID: USER_ID,
                        dialogueID: currentDialogueID,
                        content: content,
                        tags: selectedTags,
                        folderIDs: ['folder_demo']
                    })
                });

                const data = await response.json();
                addDebugLog(`âœ… æ”¶åˆ°å“åº”: ${JSON.stringify(data).substring(0, 100)}...`);

                // ç§»é™¤åŠ è½½åŠ¨ç”»
                removeLoadingMessage(loadingId);

                // æ˜¾ç¤ºAIå›å¤
                if (data.success) {
                    currentDialogueID = data.dialogueID;
                    addMessage('assistant', data.aiReply, data.extractedTags);
                    
                    // æ›´æ–°æ ‡ç­¾
                    if (data.extractedTags && data.extractedTags.length > 0) {
                        data.extractedTags.forEach(tag => {
                            const btn = document.querySelector(`[data-tag="${tag}"]`);
                            if (btn && !btn.classList.contains('active')) {
                                toggleTag(btn);
                            }
                        });
                    }
                } else {
                    addMessage('assistant', 'æŠ±æ­‰ï¼Œå‡ºç°äº†é”™è¯¯ï¼š' + (data.error || 'æœªçŸ¥é”™è¯¯'));
                }

            } catch (error) {
                removeLoadingMessage(loadingId);
                addMessage('assistant', 'âš ï¸ è¿æ¥å¤±è´¥ï¼š' + error.message);
                addDebugLog(`âŒ é”™è¯¯: ${error.message}`);
            }

            // æ¢å¤è¾“å…¥
            input.disabled = false;
            document.getElementById('sendBtn').disabled = false;
            input.focus();
        }

        // ===== ç”ŸæˆæŠ¥å‘Š =====
        async function generateReport() {
            if (!WEBHOOK_URL) {
                alert('è¯·å…ˆè®¾ç½®Webhook URLï¼');
                return;
            }

            if (selectedTags.length === 0) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå¯¹æ¯”ç»´åº¦ï¼');
                return;
            }

            addDebugLog(`ğŸ“„ ç”ŸæˆæŠ¥å‘Š: ${selectedTags.join(', ')}`);

            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'generateReport',
                        userID: USER_ID,
                        dialogueID: currentDialogueID,
                        tags: selectedTags,
                        vehicles: [
                            { name: 'ææ°ª009', image: 'placeholder.jpg' },
                            { name: 'å°é¹X9', image: 'placeholder.jpg' },
                            { name: 'è…¾åŠ¿D9', image: 'placeholder.jpg' }
                        ]
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    addReportCard(data.reportID, data.htmlContent);
                    addDebugLog(`âœ… æŠ¥å‘Šç”ŸæˆæˆåŠŸ: ${data.reportID}`);
                    addDebugLog(`ğŸ“„ HTMLå·²ä¿å­˜åˆ°Google Sheets`);
                } else {
                    alert('æŠ¥å‘Šç”Ÿæˆå¤±è´¥ï¼š' + (data.error || 'æœªçŸ¥é”™è¯¯'));
                }

            } catch (error) {
                alert('è¿æ¥å¤±è´¥ï¼š' + error.message);
                addDebugLog(`âŒ é”™è¯¯: ${error.message}`);
            }
        }

        // ===== UIæ“ä½œ =====
        function addMessage(role, text, tags = []) {
            const container = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const avatar = role === 'user' ? 'ç‹' : 'AI';
            
            let tagsHtml = '';
            if (tags && tags.length > 0) {
                tagsHtml = '<div style="margin-top: 8px;">' + 
                    tags.map(t => `<span class="mini-tag">${t}</span>`).join(' ') +
                    '</div>';
            }

            let actionsHtml = '';
            if (role === 'assistant' && selectedTags.length > 0) {
                actionsHtml = `
                    <div class="message-actions">
                        <button class="action-btn accept" onclick="generateReport()">æ¥å—æ­¤æ–¹æ¡ˆ</button>
                        <button class="action-btn reject">ç»§ç»­è®¨è®º</button>
                    </div>
                `;
            }
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">
                    <div class="message-text">${text}</div>
                    ${tagsHtml}
                    ${actionsHtml}
                </div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function addLoadingMessage() {
            const container = document.getElementById('chatContainer');
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'message assistant';
            loadingDiv.id = 'loading-' + Date.now();
            loadingDiv.innerHTML = `
                <div class="message-avatar">AI</div>
                <div class="message-content">
                    <div class="loading">
                        <div class="loading-dot"></div>
                        <div class="loading-dot"></div>
                        <div class="loading-dot"></div>
                    </div>
                </div>
            `;
            container.appendChild(loadingDiv);
            container.scrollTop = container.scrollHeight;
            return loadingDiv.id;
        }

        function removeLoadingMessage(id) {
            const loading = document.getElementById(id);
            if (loading) loading.remove();
        }

        function addReportCard(reportID, htmlContent) {
            const container = document.getElementById('chatContainer');
            const reportDiv = document.createElement('div');
            reportDiv.className = 'report-card';
            reportDiv.innerHTML = `
                <div class="report-header">
                    <div>
                        <div class="report-title">ğŸ“Š è½¦å‹å¯¹æ¯”æŠ¥å‘Š</div>
                        <div class="report-time">Created at ${new Date().toLocaleTimeString()}</div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="download-btn" onclick='previewReport(${JSON.stringify(htmlContent)})'>
                            ğŸ‘ï¸ é¢„è§ˆæŠ¥å‘Š
                        </button>
                        <button class="download-btn" onclick='printReport(${JSON.stringify(htmlContent)})'>
                            ğŸ–¨ï¸ æ‰“å°/ç”ŸæˆPDF
                        </button>
                    </div>
                </div>
                <div style="margin-top: 12px; padding: 12px; background: #f9fafb; border-radius: 6px; font-size: 12px; color: #666;">
                    <div><strong>æŠ¥å‘ŠID:</strong> ${reportID}</div>
                    <div style="margin-top: 4px;"><strong>å­˜å‚¨ä½ç½®:</strong> Google Sheets (ä»…HTML)</div>
                    <div style="margin-top: 4px; color: #10b981;">âœ… æŠ¥å‘Šå·²ç”Ÿæˆï¼ç‚¹å‡»"æ‰“å°/ç”ŸæˆPDF"ä½¿ç”¨æµè§ˆå™¨ä¿å­˜</div>
                    <div style="margin-top: 6px; color: #667eea; font-size: 11px;">
                        ğŸ’¡ æç¤ºï¼šæ‰“å°æ—¶é€‰æ‹©"å¦å­˜ä¸ºPDF"å³å¯ä¿å­˜æˆPDFæ–‡ä»¶
                    </div>
                </div>
            `;
            container.appendChild(reportDiv);
            container.scrollTop = container.scrollHeight;
        }
        
        // é¢„è§ˆæŠ¥å‘Šï¼ˆæ–°çª—å£æ‰“å¼€ï¼‰
        function previewReport(htmlContent) {
            const newWindow = window.open('', '_blank');
            newWindow.document.write(htmlContent);
            newWindow.document.close();
        }
        
        // æ‰“å°æŠ¥å‘Šï¼ˆç›´æ¥è§¦å‘æ‰“å°ï¼‰
        function printReport(htmlContent) {
            const newWindow = window.open('', '_blank');
            newWindow.document.write(htmlContent);
            newWindow.document.close();
            
            // ç­‰å¾…å†…å®¹åŠ è½½å®Œæˆåè§¦å‘æ‰“å°
            newWindow.onload = () => {
                setTimeout(() => {
                    newWindow.print();
                }, 500);
            };
        }

        function downloadReport(reportID) {
            alert('ä¸‹è½½åŠŸèƒ½ï¼šreportID = ' + reportID);
            // å®é™…åº”è¯¥æ‰“å¼€æŠ¥å‘Šé¢„è§ˆæˆ–ä¸‹è½½PDF
        }

        function addDebugLog(message) {
            const log = document.getElementById('debugLog');
            const time = new Date().toLocaleTimeString();
            const item = document.createElement('div');
            item.className = 'debug-log-item';
            item.textContent = `[${time}] ${message}`;
            log.appendChild(item);
            
            // ä¿æŒæœ€æ–°10æ¡
            while (log.children.length > 10) {
                log.removeChild(log.firstChild);
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function startNewDialogue() {
            currentDialogueID = null;
            selectedTags = [];
            document.querySelectorAll('.tag-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.innerHTML = btn.dataset.tag;
            });
            document.getElementById('chatContainer').innerHTML = `
                <div class="message assistant">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        <div class="message-text">
                            ğŸ‘‹ å¼€å§‹æ–°å¯¹è¯ï¼è¯·å‘Šè¯‰æˆ‘ä½ æƒ³å¯¹æ¯”çš„è½¦å‹ç»´åº¦ã€‚
                        </div>
                    </div>
                </div>
            `;
            addDebugLog('ğŸ†• å¼€å§‹æ–°å¯¹è¯');
        }

        async function loadDialogueList() {
            // TODO: å®ç°åŠ è½½å†å²å¯¹è¯åˆ—è¡¨
            addDebugLog('ğŸ“‹ åŠ è½½å¯¹è¯åˆ—è¡¨...');
        }

        // ===== å¯åŠ¨ =====
        init();
    </script>
</body>
</html>

