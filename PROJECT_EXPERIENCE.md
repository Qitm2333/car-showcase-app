# ğŸš— Car Showcase App - å®Œæ•´é¡¹ç›®ç»éªŒæ–‡æ¡£

> ä¸€ä¸ªé›†æˆ AI åˆ†æã€æ™ºèƒ½æ•´ç†ã€æ”¶è—ç®¡ç†çš„æ±½è½¦è®¾è®¡è¾…åŠ©å¹³å°

**é¡¹ç›®ä»“åº“**: https://github.com/Qitm2333/car-showcase-app  
**çº¿ä¸Šåœ°å€**: https://car-showcase-app.vercel.app  
**æœ€åæ›´æ–°**: 2024å¹´11æœˆ

---

## ğŸ“š ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
3. [æ ¸å¿ƒåŠŸèƒ½æ¨¡å—](#æ ¸å¿ƒåŠŸèƒ½æ¨¡å—)
4. [å…³é”®æŠ€æœ¯å®ç°](#å…³é”®æŠ€æœ¯å®ç°)
5. [é‡è¦é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#é‡è¦é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
6. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
7. [éƒ¨ç½²ä¸è¿ç»´](#éƒ¨ç½²ä¸è¿ç»´)
8. [æœ€ä½³å®è·µæ€»ç»“](#æœ€ä½³å®è·µæ€»ç»“)
9. [æœªæ¥ä¼˜åŒ–æ–¹å‘](#æœªæ¥ä¼˜åŒ–æ–¹å‘)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®èƒŒæ™¯

è¿™æ˜¯ä¸€ä¸ªä¸ºæ±½è½¦è®¾è®¡å¸ˆæ‰“é€ çš„**æ™ºèƒ½è¾…åŠ©å¹³å°**ï¼Œæ—¨åœ¨è§£å†³ä»¥ä¸‹ç—›ç‚¹ï¼š
- ğŸ“¸ **æ‰¾å›¾éš¾**ï¼šä»æµ·é‡æ±½è½¦å›¾ç‰‡ä¸­å¿«é€Ÿæ‰¾åˆ°éœ€è¦çš„ç´ æ
- ğŸ“Š **åˆ†ææ…¢**ï¼šæ‰‹åŠ¨æ•´ç†å’Œåˆ†æè®¾è®¡è¶‹åŠ¿è€—æ—¶è€—åŠ›
- ğŸ’¾ **ç®¡ç†ä¹±**ï¼šè®¾è®¡ç´ æåˆ†æ•£ï¼Œéš¾ä»¥ç³»ç»ŸåŒ–ç®¡ç†
- ğŸ¤– **æ— AIæ”¯æŒ**ï¼šç¼ºä¹æ™ºèƒ½åŒ–çš„è®¾è®¡å»ºè®®å’Œè¶‹åŠ¿åˆ†æ

### 1.2 æ ¸å¿ƒä»·å€¼

- âœ… **æ™ºèƒ½ç­›é€‰**ï¼šå¤šç»´åº¦ç­›é€‰ï¼ˆå“ç‰Œã€è½¦å‹ã€è§†è§’ã€éƒ¨ä»¶ã€æ—¶é—´ï¼‰
- âœ… **AI åˆ†æ**ï¼šä¸ RAG æ¨¡å‹å¯¹è¯ï¼Œç”Ÿæˆä¸“ä¸šè®¾è®¡æŠ¥å‘Š
- âœ… **æ”¶è—ç®¡ç†**ï¼šåˆ›å»ºæ”¶è—å¤¹ï¼Œåˆ†ç±»ç®¡ç†è®¾è®¡ç´ æ
- âœ… **æ™ºèƒ½æ•´ç†**ï¼šä¸€é”®æ‰¹é‡è·å–å¹¶æ•´ç†è½¦å‹å›¾ç‰‡
- âœ… **æœç´¢åŠŸèƒ½**ï¼šå…¨å±€æœç´¢ï¼Œå¿«é€Ÿå®šä½ç›®æ ‡è½¦å‹
- âœ… **è¶£å‘³å½©è›‹**ï¼šç™»å½•é¡µé’è›™åƒèšŠå­å°æ¸¸æˆ ğŸ¸

### 1.3 ç”¨æˆ·è§’è‰²

- **æ±½è½¦è®¾è®¡å¸ˆ**ï¼šä¸»è¦ç”¨æˆ·ç¾¤ä½“ï¼Œéœ€è¦å¤§é‡å‚è€ƒç´ æå’Œè¶‹åŠ¿åˆ†æ
- **äº§å“ç»ç†**ï¼šæŸ¥çœ‹è®¾è®¡è¶‹åŠ¿ï¼Œåšäº§å“å†³ç­–
- **å­¦ç”Ÿ/çˆ±å¥½è€…**ï¼šå­¦ä¹ æ±½è½¦è®¾è®¡ï¼Œç§¯ç´¯ç´ æ

---

## 2. æŠ€æœ¯æ¶æ„

### 2.1 æŠ€æœ¯æ ˆ

#### å‰ç«¯
```typescript
- React 18 + TypeScript        // æ ¸å¿ƒæ¡†æ¶
- Vite                          // æ„å»ºå·¥å…·
- React Router v6               // è·¯ç”±ç®¡ç†
- Tailwind CSS                  // æ ·å¼æ¡†æ¶
- Shadcn/ui                     // UI ç»„ä»¶åº“
- Canvas API                    // å½©è›‹æ¸¸æˆ
```

#### åç«¯
```
- N8N (No-code Automation)      // åç«¯é€»è¾‘ç¼–æ’
- Google Sheets                 // æ•°æ®å­˜å‚¨
- DeepSeek API                  // AI å¯¹è¯æ¨¡å‹
- æ±½è½¦ä¹‹å®¶ API                   // è½¦å‹æ•°æ®æº
```

#### éƒ¨ç½²
```
- Vercel                        // å‰ç«¯æ‰˜ç®¡
- N8N Cloud                     // åç«¯æœåŠ¡
- GitHub                        // ä»£ç ç®¡ç†
```

### 2.2 æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Login Page  â”‚  â”‚ Car Showcase â”‚  â”‚  Favorites   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ AI Analysis  â”‚  â”‚    Search    â”‚  â”‚  Car Detail  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ HTTPS/JSON
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        N8N Workflows                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚    Login     â”‚  â”‚  Car Filter  â”‚  â”‚  Car Search  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Favorite   â”‚  â”‚ AI Analysis  â”‚  â”‚Smart Organizeâ”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Google   â”‚  â”‚  DeepSeek  â”‚
â”‚   Sheets   â”‚  â”‚     AI     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 æ•°æ®æµ

#### ç”¨æˆ·ç™»å½•æµç¨‹
```
1. ç”¨æˆ·è¾“å…¥é‚€è¯·ç 
2. å‰ç«¯è°ƒç”¨ N8N Login API
3. N8N æŸ¥è¯¢ Google Sheets éªŒè¯é‚€è¯·ç 
4. è¿”å›ç”¨æˆ·ä¿¡æ¯ (userName, userID)
5. å‰ç«¯å­˜å‚¨åˆ° Context å’Œ localStorage
6. è·³è½¬åˆ°ä¸»é¡µé¢
```

#### AI å¯¹è¯æµç¨‹
```
1. ç”¨æˆ·å‘é€æ¶ˆæ¯ + é™„åŠ æ ‡ç­¾ï¼ˆæ”¶è—å¤¹åç§°ï¼‰
2. N8N æ¥æ”¶æ¶ˆæ¯å’Œæ ‡ç­¾
3. æ³¨å…¥æ ‡ç­¾åˆ° AI Prompt
4. è°ƒç”¨ DeepSeek API ç”Ÿæˆå›å¤
5. æ£€æµ‹æ˜¯å¦åŒ…å« [PROPOSAL] æ ‡è®°
6. å¦‚æœæ˜¯ææ¡ˆï¼Œæå–è½¦å‹åˆ—è¡¨
7. æ ¹æ®æ ‡ç­¾ç­›é€‰å›¾ç‰‡ç±»åˆ«
8. è°ƒç”¨æ±½è½¦ä¹‹å®¶ API è·å–å›¾ç‰‡
9. ç”Ÿæˆ AI æŠ¥å‘Šå¹¶å­˜å‚¨åˆ° Google Sheets
10. è¿”å›ç»“æœåˆ°å‰ç«¯
```

---

## 3. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 3.1 ç™»å½•è®¤è¯ (Login)

**æ–‡ä»¶ä½ç½®**: `src/pages/Login.tsx`

#### åŠŸèƒ½ç‰¹æ€§
- âœ… é‚€è¯·ç éªŒè¯
- âœ… ç”¨æˆ·ä¿¡æ¯å­˜å‚¨ï¼ˆContext + localStorageï¼‰
- âœ… æµåŠ¨æ¸å˜èƒŒæ™¯åŠ¨ç”»
- âœ… æ–‡å­—è½®æ’­åŠ¨ç”»ï¼ˆ3ç»„æ–‡æ¡ˆå¾ªç¯ï¼‰
- âœ… å½©è›‹ï¼šè¿ç»­ç‚¹å‡» logo 3 æ¬¡è§¦å‘é’è›™åƒèšŠå­æ¸¸æˆ

#### å…³é”®ä»£ç 
```tsx
// ç™»å½•é€»è¾‘
const handleLogin = async () => {
  const response = await fetch(API_ENDPOINTS.LOGIN, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ inviteCode: inviteCode.trim() })
  });
  
  const data = await response.json();
  
  if (data.success) {
    setInviteCode(data.data.inviteCode);
    setUserName(data.data.userName);
    navigate("/car-showcase");
  }
};
```

#### å½©è›‹æ¸¸æˆå®ç°
- **Canvas + requestAnimationFrame**ï¼šé«˜æ€§èƒ½åŠ¨ç”»å¾ªç¯
- **è®¾å¤‡åƒç´ æ¯”é€‚é…**ï¼šè§£å†³ Retina å±æ¨¡ç³Šé—®é¢˜
- **ç¼“åŠ¨å‡½æ•°**ï¼šä½¿ç”¨ easeOutQuadã€easeInBack ç­‰å®ç°æµç•…åŠ¨ç”»
- **ç‰©ç†æ¨¡æ‹Ÿ**ï¼šèšŠå­ 8 å­—å½¢é£è¡Œï¼Œé’è›™èˆŒå¤´å¼¹æ€§æ•ˆæœ

**å…³é”®ä¼˜åŒ–**ï¼š
```tsx
// æ”¯æŒé«˜DPIå±å¹•
const dpr = window.devicePixelRatio || 1;
canvas.width = displayWidth * dpr;
canvas.height = displayHeight * dpr;
ctx.scale(dpr, dpr);
```

### 3.2 çµæ„Ÿæœé›† (Car Showcase)

**æ–‡ä»¶ä½ç½®**: `src/pages/CarShowcaseMain.tsx`

#### åŠŸèƒ½ç‰¹æ€§
- âœ… å¤šç»´åº¦ç­›é€‰ï¼ˆæ ‡ç­¾ã€å“ç‰Œã€è½¦å‹ã€è§†è§’ï¼‰
- âœ… ç€‘å¸ƒæµå¸ƒå±€å±•ç¤º
- âœ… æ”¶è—åŠŸèƒ½ï¼ˆç‚¹å‡»æ”¶è—æŒ‰é’®ï¼‰
- âœ… ç¼“å­˜æœºåˆ¶ï¼ˆç­›é€‰æ¡ä»¶æŒä¹…åŒ–ï¼‰
- âœ… éª¨æ¶å±åŠ è½½

#### ç¼“å­˜æœºåˆ¶ï¼ˆå…³é”®åˆ›æ–°ï¼‰

**é—®é¢˜**ï¼šæ¯æ¬¡åˆ‡æ¢é¡µé¢å›æ¥ï¼Œç­›é€‰æ¡ä»¶é‡ç½®ï¼Œç”¨æˆ·ä½“éªŒå·®

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨æ¨¡å—çº§å˜é‡ç¼“å­˜çŠ¶æ€

```tsx
// æ¨¡å—çº§ç¼“å­˜å˜é‡ï¼ˆåœ¨ç»„ä»¶å¤–éƒ¨ï¼‰
let hasEverInitialized = false;
let cachedFilteredCars: Car[] = [];
let cachedHasSearched = false;
let cachedSelectedBrand = '';
let cachedSelectedModel = '';
let cachedSelectedView = '';
let cachedLabels: string[] = [];

// ç»„ä»¶åˆå§‹åŒ–æ—¶ä»ç¼“å­˜æ¢å¤
useEffect(() => {
  if (hasEverInitialized) {
    setFilteredCars(cachedFilteredCars);
    setHasSearched(cachedHasSearched);
    // ...æ¢å¤å…¶ä»–çŠ¶æ€
    return; // ä¸æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘
  }
  
  // é¦–æ¬¡è¿›å…¥æ‰æ‰§è¡Œ
  hasEverInitialized = true;
  // ...åˆå§‹åŒ–é€»è¾‘
}, []);
```

**ä¸ºä»€ä¹ˆä¸ç”¨ useStateï¼Ÿ**
- useState åœ¨ç»„ä»¶å¸è½½æ—¶ä¼šä¸¢å¤±
- localStorage ä¼šå¼•å…¥å¼‚æ­¥é—®é¢˜
- æ¨¡å—çº§å˜é‡åœ¨åº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…æŒä¹…å­˜åœ¨

### 3.3 AI åˆ†æ (AI Analysis)

**æ–‡ä»¶ä½ç½®**: `src/pages/AIAnalysis.tsx`

#### åŠŸèƒ½ç‰¹æ€§
- âœ… å¯¹è¯å†å²ç®¡ç†ï¼ˆå·¦ä¾§è¾¹æ ï¼‰
- âœ… å®æ—¶å¯¹è¯ï¼ˆæ¶ˆæ¯æ°”æ³¡ï¼‰
- âœ… æ ‡ç­¾ç³»ç»Ÿï¼ˆå…³è”æ”¶è—å¤¹ï¼‰
- âœ… æŠ¥å‘Šç”Ÿæˆï¼ˆAccept/Reject æŒ‰é’®ï¼‰
- âœ… éª¨æ¶å±åŠ è½½
- âœ… è‡ªåŠ¨æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯

#### å…³é”®æ¶æ„ï¼šAIAnalysisContext

```tsx
// Context ç®¡ç†å…¨å±€çŠ¶æ€
interface AIAnalysisContextValue {
  dialogues: Dialogue[];              // å¯¹è¯åˆ—è¡¨
  currentDialogue: Dialogue | null;   // å½“å‰å¯¹è¯
  messages: Message[];                // æ¶ˆæ¯åˆ—è¡¨
  currentTags: string[];              // å½“å‰æ ‡ç­¾
  sendMessage: (content: string, tags: string[]) => Promise<void>;
  generateReport: (dialogueId: string) => Promise<void>;
  // ...
}
```

**æ•°æ®æµè®¾è®¡**ï¼š
1. **å¯¹è¯åˆ—è¡¨** â†’ å·¦ä¾§è¾¹æ å±•ç¤º
2. **å¯¹è¯è¯¦æƒ…** â†’ ç‚¹å‡»å¯¹è¯åŠ è½½å†å²æ¶ˆæ¯
3. **å‘é€æ¶ˆæ¯** â†’ ç«‹å³æ·»åŠ åˆ° UIï¼ˆä¹è§‚æ›´æ–°ï¼‰
4. **ç”ŸæˆæŠ¥å‘Š** â†’ æ˜¾ç¤ºåŠ è½½åŠ¨ç”» â†’ æŠ¥å‘Šå¡ç‰‡

#### æ ‡ç­¾æ³¨å…¥æœºåˆ¶ï¼ˆåˆ›æ–°ç‚¹ï¼‰

**éœ€æ±‚**ï¼šAI éœ€è¦çŸ¥é“ç”¨æˆ·ä»å“ªä¸ªæ”¶è—å¤¹è¿›å…¥ï¼Œä»¥ä¾¿ç”Ÿæˆç›¸å…³æŠ¥å‘Š

**å®ç°**ï¼š
```tsx
// 1. å‰ç«¯å‘é€æ¶ˆæ¯æ—¶é™„å¸¦æ ‡ç­¾
sendMessage(content, ['æ”¶è—å¤¹A', 'æ”¶è—å¤¹B']);

// 2. N8N æ¥æ”¶å¹¶æ³¨å…¥åˆ° Prompt
const prompt = `
ç”¨æˆ·å…³æ³¨çš„ä¸»é¢˜æ ‡ç­¾ï¼š${tags.join(', ')}
è¯·æ ¹æ®è¿™äº›æ ‡ç­¾ç”Ÿæˆç›¸å…³çš„è®¾è®¡åˆ†æ...
`;

// 3. AI è¿”å›é’ˆå¯¹æ€§æ›´å¼ºçš„å›å¤
```

#### æŠ¥å‘ŠçŠ¶æ€ç®¡ç†ï¼ˆéš¾ç‚¹ï¼‰

**é—®é¢˜**ï¼šæŠ¥å‘Šç”Ÿæˆåï¼Œæ–°æ¶ˆæ¯ä¼šå†æ¬¡è§¦å‘"æ­£åœ¨ç”ŸæˆæŠ¥å‘Š"çš„é”™è¯¯æç¤º

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨ ref å®ç°ç«‹å³æ¸…ç†

```tsx
// 1. åˆ›å»ºæ¸…ç†å‡½æ•° ref
const clearReportStatesRef = useRef<(() => void) | null>(null);

// 2. åœ¨æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶ä¸­æ³¨å†Œæ¸…ç†å‡½æ•°
clearReportStatesRef.current = () => {
  setGeneratedReport(null);
  setIsGeneratingReport(false);
  setReportCompleted(false);
};

// 3. å‘é€æ–°æ¶ˆæ¯å‰ç«‹å³è°ƒç”¨
const handleSend = () => {
  clearReportStatesRef.current?.(); // ç«‹å³æ¸…ç†
  sendMessage(content, tags);
};
```

### 3.4 æ”¶è—ç®¡ç† (Favorites)

**æ–‡ä»¶ä½ç½®**: `src/pages/FavoritesMain.tsx`, `src/pages/FavoritesDetail.tsx`

#### åŠŸèƒ½ç‰¹æ€§
- âœ… åˆ›å»º/åˆ é™¤æ”¶è—å¤¹
- âœ… æŸ¥çœ‹æ”¶è—å¤¹å†…å®¹ï¼ˆç½‘æ ¼å¸ƒå±€ï¼‰
- âœ… AI åˆ†æï¼ˆè·³è½¬å¹¶è‡ªåŠ¨é™„åŠ æ ‡ç­¾ï¼‰
- âœ… æ™ºèƒ½æ•´ç†ï¼ˆæ‰¹é‡è·å–å›¾ç‰‡ï¼‰
- âœ… å›¾ç‰‡æŸ¥çœ‹å™¨ï¼ˆå¤§å›¾é¢„è§ˆï¼‰

#### æ™ºèƒ½æ•´ç†åŠŸèƒ½

**æµç¨‹**ï¼š
1. ç”¨æˆ·è¾“å…¥è½¦å‹åç§°ï¼ˆæœ€å¤š5ä¸ªï¼‰
2. é€‰æ‹©ç­›é€‰ç±»åˆ«ï¼ˆå¤–è§‚/å†…é¥°/å…¨éƒ¨ï¼‰
3. é€‰æ‹©è§†è§’ï¼ˆæ­£é¢/ä¾§é¢/åé¢/å…¨éƒ¨ï¼‰
4. è°ƒç”¨ N8N `smart-organize-to-folder` workflow
5. N8N è°ƒç”¨æ±½è½¦ä¹‹å®¶ API è·å–å›¾ç‰‡
6. ä¿å­˜åˆ°å½“å‰æ”¶è—å¤¹
7. æ˜¾ç¤ºæˆåŠŸå¯¹è¯æ¡†ï¼ˆå¡ç‰‡å¼ï¼‰

**N8N Workflow å…³é”®èŠ‚ç‚¹**ï¼š
```javascript
// èŠ‚ç‚¹1: éªŒè¯å‚æ•°
const { userID, folderID, carNames } = $input.json;
if (carNames.length > 5) {
  throw new Error('æœ€å¤šåªèƒ½è¾“å…¥5ä¸ªè½¦å‹');
}

// èŠ‚ç‚¹2: è°ƒç”¨å›¾ç‰‡è·å–API
const response = await fetch('get-car-images', {
  method: 'POST',
  body: JSON.stringify({ carNames, filterCategory, filterViewType })
});

// èŠ‚ç‚¹3: å¤„ç†å“åº”å¹¶å±•å¹³å›¾ç‰‡æ•°ç»„
const images = results.flatMap(r => 
  r.images.map(img => ({
    ...img,
    carName: r.carName,
    carId: r.carId
  }))
);

// èŠ‚ç‚¹4: ç”Ÿæˆæ”¶è—é¡¹å¹¶ä¿å­˜åˆ° Google Sheets
images.forEach(img => {
  saveFavorite({
    favoriteID: generateID(),
    userID, folderID,
    carID: img.carId,
    imageURL: img.url,
    // ...
  });
});
```

### 3.5 å…¨å±€æœç´¢ (Search)

**æ–‡ä»¶ä½ç½®**: `src/pages/SearchResults.tsx`

#### åŠŸèƒ½ç‰¹æ€§
- âœ… å…¨å±€æœç´¢æ¡†ï¼ˆæ‰€æœ‰é¡µé¢å¯è§ï¼‰
- âœ… å®æ—¶æœç´¢ï¼ˆè¾“å…¥å³æœç´¢ï¼‰
- âœ… ç»“æœå±•ç¤ºï¼ˆç½‘æ ¼å¸ƒå±€ï¼‰
- âœ… æ”¶è—åŠŸèƒ½ï¼ˆå³ä¸Šè§’æ”¶è—æŒ‰é’®ï¼‰

#### æœç´¢æœåŠ¡

```typescript
// src/services/carSearchService.ts
export async function searchCars(keyword: string): Promise<Car[]> {
  const response = await fetch(API_ENDPOINTS.CAR_SEARCH, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ keyword })
  });
  
  const data = await response.json();
  return transformToCarObjects(data);
}
```

---

## 4. å…³é”®æŠ€æœ¯å®ç°

### 4.1 çŠ¶æ€ç®¡ç†æ¶æ„

#### Context è®¾è®¡åŸåˆ™

**ä¸ºä»€ä¹ˆé€‰æ‹© Context è€Œä¸æ˜¯ Redux/Zustandï¼Ÿ**
- âœ… é¡¹ç›®è§„æ¨¡é€‚ä¸­ï¼Œä¸éœ€è¦å¤æ‚çŠ¶æ€ç®¡ç†
- âœ… Context è¶³å¤Ÿè½»é‡ï¼Œå­¦ä¹ æˆæœ¬ä½
- âœ… React 18 çš„ Context æ€§èƒ½å·²ä¼˜åŒ–

**Context åˆ†å±‚è®¾è®¡**ï¼š
```tsx
// 1. UserContext - ç”¨æˆ·ä¿¡æ¯ï¼ˆå…¨å±€ï¼‰
<UserProvider>
  
  // 2. DebugContext - è°ƒè¯•å·¥å…·ï¼ˆå…¨å±€ï¼‰
  <DebugProvider>
    
    // 3. AIAnalysisContext - AI å¯¹è¯ï¼ˆå±€éƒ¨ï¼‰
    <AIAnalysisProvider>
      
      // 4. FolderCacheContext - æ”¶è—å¤¹ç¼“å­˜ï¼ˆå±€éƒ¨ï¼‰
      <FolderCacheProvider>
        {children}
      </FolderCacheProvider>
      
    </AIAnalysisProvider>
    
  </DebugProvider>
  
</UserProvider>
```

**ä¼˜åŒ–æŠ€å·§**ï¼š
```tsx
// âŒ ä¸å¥½çš„åšæ³•ï¼šæ•´ä¸ª Context ä½œä¸ºä¾èµ–
const { user, folders, messages } = useContext(AppContext);
useEffect(() => {
  // ä»»ä½•ä¸€ä¸ªå€¼å˜åŒ–éƒ½ä¼šè§¦å‘
}, [user, folders, messages]);

// âœ… å¥½çš„åšæ³•ï¼šåªè®¢é˜…éœ€è¦çš„å€¼
const { messages } = useAIAnalysis();
useEffect(() => {
  // åªæœ‰ messages å˜åŒ–æ‰è§¦å‘
}, [messages]);
```

### 4.2 ç»„ä»¶å¤ç”¨ä¸ Figma Code Connect

#### é—®é¢˜ï¼šFigma å¯¼å‡ºçš„ä»£ç ä¸å¯å¤ç”¨

**Figma å¯¼å‡ºç‰¹ç‚¹**ï¼š
- ä½¿ç”¨ç»å¯¹å®šä½ (`absolute`)
- ç¡¬ç¼–ç åƒç´ å€¼ (`px`)
- ç»„ä»¶ç»“æ„æ‰å¹³ï¼Œéš¾ä»¥ç»´æŠ¤

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **æå–å¯å¤ç”¨ç»„ä»¶**ï¼šå°† Figma ç»„ä»¶æ‹†åˆ†ä¸ºç‹¬ç«‹çš„ React ç»„ä»¶
2. **ä½¿ç”¨ Tailwind å“åº”å¼å•ä½**ï¼š`rem`ã€`%`ã€`vh`/`vw`
3. **åŠ¨æ€è®¡ç®—ä½ç½®**ï¼šä½¿ç”¨ `flexbox` å’Œ `grid` ä»£æ›¿ç»å¯¹å®šä½

**ç¤ºä¾‹**ï¼š
```tsx
// âŒ Figma å¯¼å‡ºçš„ä»£ç 
<div style={{ position: 'absolute', left: '20px', top: '30px', width: '300px' }}>
  <span style={{ fontSize: '16px' }}>æ ‡é¢˜</span>
</div>

// âœ… ä¼˜åŒ–åçš„ä»£ç 
<div className="flex items-center p-5 w-[300px]">
  <span className="text-base font-medium">æ ‡é¢˜</span>
</div>
```

### 4.3 é«˜DPIå±å¹•é€‚é…

#### é—®é¢˜ï¼šCanvas åœ¨ Retina å±ä¸Šæ¨¡ç³Š

**åŸå› **ï¼š
- Retina å±çš„ `devicePixelRatio` ä¸º 2 æˆ– 3
- Canvas é»˜è®¤æŒ‰ CSS åƒç´ æ¸²æŸ“
- å®é™…éœ€è¦æ¸²æŸ“çš„ç‰©ç†åƒç´ æ›´å¤š

**è§£å†³æ–¹æ¡ˆ**ï¼š
```tsx
const resizeCanvas = () => {
  const dpr = window.devicePixelRatio || 1;
  const displayWidth = parent.clientWidth;
  const displayHeight = parent.clientHeight;
  
  // 1. è®¾ç½®å®é™…æ¸²æŸ“å°ºå¯¸ï¼ˆç‰©ç†åƒç´ ï¼‰
  canvas.width = displayWidth * dpr;
  canvas.height = displayHeight * dpr;
  
  // 2. è®¾ç½® CSS æ˜¾ç¤ºå°ºå¯¸ï¼ˆCSS åƒç´ ï¼‰
  canvas.style.width = `${displayWidth}px`;
  canvas.style.height = `${displayHeight}px`;
  
  // 3. ç¼©æ”¾ç»˜å›¾ä¸Šä¸‹æ–‡
  ctx.scale(dpr, dpr);
};
```

**æ•ˆæœå¯¹æ¯”**ï¼š
- ä¼˜åŒ–å‰ï¼šæ–‡å­—å’Œå›¾å½¢æ¨¡ç³Šï¼Œè¾¹ç¼˜æœ‰é”¯é½¿
- ä¼˜åŒ–åï¼šæ¸…æ™°é”åˆ©ï¼Œä¸ç³»ç»ŸåŸç”ŸUIæ— å¼‚

### 4.4 N8N Workflow è®¾è®¡æ¨¡å¼

#### æ¨¡å¼1ï¼šéªŒè¯ â†’ å¤„ç† â†’ å­˜å‚¨ â†’ å“åº”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Webhook    â”‚ æ¥æ”¶è¯·æ±‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  éªŒè¯å‚æ•°    â”‚ æ ¡éªŒå¿…å¡«å­—æ®µ
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸šåŠ¡å¤„ç†    â”‚ è°ƒç”¨APIã€æ•°æ®è½¬æ¢
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ Google Sheetsâ”‚ æŒä¹…åŒ–å­˜å‚¨
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ æ ¼å¼åŒ–å“åº”   â”‚ è¿”å›JSON
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  Respond    â”‚ å‘é€ç»™å‰ç«¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ¨¡å¼2ï¼šæ¡ä»¶åˆ†æ”¯å¤„ç†

```javascript
// IF èŠ‚ç‚¹ç¤ºä¾‹ï¼šæ£€æµ‹ AI å“åº”æ˜¯å¦åŒ…å«ææ¡ˆ
{{ $json.content.includes('[PROPOSAL]') }}

// True åˆ†æ”¯ï¼šæå–è½¦å‹åˆ—è¡¨ â†’ è·å–å›¾ç‰‡ â†’ ç”ŸæˆæŠ¥å‘Š
// False åˆ†æ”¯ï¼šç›´æ¥è¿”å›å¯¹è¯å†…å®¹
```

#### æœ€ä½³å®è·µ

1. **é”™è¯¯å¤„ç†**ï¼šæ¯ä¸ªå…³é”®èŠ‚ç‚¹éƒ½è¦æœ‰ Try-Catch
```javascript
try {
  const response = await fetch(url);
  return { success: true, data: response };
} catch (error) {
  return { success: false, error: error.message };
}
```

2. **æ—¥å¿—è®°å½•**ï¼šä½¿ç”¨ `console.log` è°ƒè¯•
```javascript
console.log('========== èŠ‚ç‚¹åç§° ==========');
console.log('è¾“å…¥æ•°æ®:', $input.json);
console.log('å¤„ç†ç»“æœ:', result);
console.log('================================');
```

3. **æ•°æ®è½¬æ¢**ï¼šç»Ÿä¸€æ ¼å¼
```javascript
// æ ‡å‡†åŒ–å“åº”æ ¼å¼
return {
  success: true,
  message: 'æ“ä½œæˆåŠŸ',
  data: { /* ä¸šåŠ¡æ•°æ® */ },
  timestamp: new Date().toISOString()
};
```

4. **Auto-Map Input Data**ï¼šåŠ¨æ€æ›´æ–°å­—æ®µ
```javascript
// Google Sheets èŠ‚ç‚¹é…ç½®
{
  "operation": "update",
  "options": {
    "autoMapInputData": true, // â­ å…³é”®ï¼
    "matchingColumns": ["dialogueID"] // åŒ¹é…å­—æ®µ
  }
}
```

**ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ**
- åªæ›´æ–°ä¼ å…¥çš„å­—æ®µ
- ä¸ä¼ å…¥çš„å­—æ®µä¿æŒåŸå€¼
- è§£å†³äº† `title` å­—æ®µè¢«è¦†ç›–çš„é—®é¢˜

---

## 5. é‡è¦é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 5.1 AI å¯¹è¯ Title æ¶ˆå¤±é—®é¢˜

#### é—®é¢˜æè¿°
ç”¨æˆ·æŠ¥å‘Šï¼šç¬¬ä¸€æ¬¡åˆ›å»ºå¯¹è¯æ—¶æœ‰æ ‡é¢˜ï¼Œç¬¬äºŒæ¬¡å‘é€æ¶ˆæ¯åæ ‡é¢˜å˜æˆç©ºç™½

#### æ’æŸ¥è¿‡ç¨‹
1. **å‰ç«¯æ—¥å¿—**ï¼šç¡®è®¤å‰ç«¯æ²¡æœ‰å‘é€ `title` å­—æ®µ âœ…
2. **N8Næ—¥å¿—**ï¼šå‘ç° Google Sheets æ›´æ–°æ—¶ `title` è¢«è¦†ç›–ä¸ºç©º
3. **Google Sheets é…ç½®**ï¼šæœªä½¿ç”¨ `Auto-Map Input Data`

#### æ ¹æœ¬åŸå› 
Google Sheets èŠ‚ç‚¹é»˜è®¤æ›´æ–°æ‰€æœ‰å­—æ®µï¼Œå³ä½¿å­—æ®µå€¼ä¸º `undefined`ï¼Œä¹Ÿä¼šå†™å…¥ç©ºå€¼

#### è§£å†³æ–¹æ¡ˆ
```javascript
// 1. å¯ç”¨ Auto-Map Input Data
{
  "autoMapInputData": true,
  "matchingColumns": ["dialogueID"]
}

// 2. ç¡®ä¿é¦–æ¬¡åˆ›å»ºæ—¶ä¼ å…¥ title
const newDialogue = {
  dialogueID: generateID(),
  title: firstMessage, // â­ åªåœ¨åˆ›å»ºæ—¶ä¼ å…¥
  conversationHistory: JSON.stringify([...]),
  // ...
};

// 3. åç»­æ›´æ–°æ—¶ä¸ä¼ å…¥ title
const updateData = {
  dialogueID: existingID,
  conversationHistory: JSON.stringify([...]),
  // title ä¸ä¼ å…¥ï¼Œä¿æŒåŸå€¼
};
```

**ç»éªŒæ€»ç»“**ï¼š
- âœ… ä½¿ç”¨ `Auto-Map Input Data` é¿å…å­—æ®µè¦†ç›–
- âœ… æ˜ç¡®åŒºåˆ†"åˆ›å»º"å’Œ"æ›´æ–°"çš„æ•°æ®ç»“æ„
- âœ… åœ¨ Code èŠ‚ç‚¹ä¸­æ˜¾å¼è¿‡æ»¤æ‰ä¸éœ€è¦æ›´æ–°çš„å­—æ®µ

### 5.2 Canvas ç¼©æ”¾å¯¼è‡´ç•Œé¢è£å‰ª

#### é—®é¢˜æè¿°
å°è¯•ä½¿ç”¨ `zoom` æˆ– `transform: scale()` ç¼©æ”¾æ•´ä¸ªç•Œé¢ï¼Œç»“æœå¯¼è‡´å†…å®¹è¢«è£å‰ª

#### å°è¯•çš„æ–¹æ¡ˆ

**æ–¹æ¡ˆAï¼šCSS `zoom`**
```css
body {
  zoom: 0.75;
}
```
âŒ é—®é¢˜ï¼š
- æ»šåŠ¨æ¡è®¡ç®—é”™è¯¯
- å›ºå®šå®šä½å…ƒç´ ä½ç½®åç§»
- éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒ

**æ–¹æ¡ˆBï¼šCSS `transform: scale()`**
```css
#root {
  transform: scale(0.75);
  transform-origin: top left;
}
```
âŒ é—®é¢˜ï¼š
- å®¹å™¨å°ºå¯¸ä¸å˜ï¼Œå†…å®¹è¢«è£å‰ª
- æ»šåŠ¨åŒºåŸŸè®¡ç®—é”™è¯¯
- äº¤äº’äº‹ä»¶åæ ‡åç§»

**æ–¹æ¡ˆCï¼šå®Œå…¨é‡æ„ï¼ˆremå•ä½ï¼‰**
```css
html {
  font-size: 12px; /* é»˜è®¤16px * 0.75 */
}
```
âŒ é—®é¢˜ï¼š
- å·¥ä½œé‡å·¨å¤§
- Figma å¯¼å‡ºçš„ä»£ç å…¨æ˜¯ px
- é£é™©é«˜ï¼Œå®¹æ˜“å¼•å…¥æ–°bug

#### æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼šæµè§ˆå™¨ç¼©æ”¾ + æç¤º

```tsx
// 1. æ·»åŠ ç¼©æ”¾æç¤ºç»„ä»¶
<ScaleHintManager />

// 2. é¦–æ¬¡ç™»å½•è‡ªåŠ¨å¼¹å‡ºæç¤º
useEffect(() => {
  const hasShown = localStorage.getItem('scale-hint-shown');
  if (!hasShown) {
    openScaleDialog();
  }
}, []);

// 3. æç¤ºç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨å¿«æ·é”®
Cmd/Ctrl + -  // ç¼©å°
Cmd/Ctrl + +  // æ”¾å¤§
Cmd/Ctrl + 0  // é‡ç½®
```

**ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ**
- âœ… åˆ©ç”¨æµè§ˆå™¨åŸç”Ÿèƒ½åŠ›ï¼Œç¨³å®šå¯é 
- âœ… ç”¨æˆ·å¯ä»¥æ ¹æ®å±å¹•å¤§å°è‡ªè¡Œè°ƒæ•´
- âœ… ä¸éœ€è¦ä¿®æ”¹ä»£ç ï¼Œé›¶é£é™©
- âœ… ç¬¦åˆç”¨æˆ·ä¹ æƒ¯ï¼ˆå¤§å¤šæ•°äººçŸ¥é“æµè§ˆå™¨ç¼©æ”¾ï¼‰

**ç»éªŒæ€»ç»“**ï¼š
> "ä¸æ˜¯æ‰€æœ‰é—®é¢˜éƒ½éœ€è¦ä»£ç è§£å†³ï¼Œæœ‰æ—¶å€™æœ€å¥½çš„æ–¹æ¡ˆæ˜¯ç”¨æˆ·æ•™è‚²"

### 5.3 æŠ¥å‘Šç”Ÿæˆåå†å¯¹è¯è§¦å‘é”™è¯¯æç¤º

#### é—®é¢˜æè¿°
ç”ŸæˆæŠ¥å‘Šåï¼Œå‘é€æ–°æ¶ˆæ¯æ—¶ä¼šçŸ­æš‚æ˜¾ç¤º"æ­£åœ¨ç”ŸæˆæŠ¥å‘Š..."ï¼Œç„¶åæ‰æ­£å¸¸å¯¹è¯

#### åŸå› åˆ†æ
```tsx
// useEffect åœ¨æ¸²æŸ“åæ‰æ‰§è¡Œ
useEffect(() => {
  if (messages.length > 0 && messages[messages.length - 1].isUser) {
    setGeneratedReport(null);
    setIsGeneratingReport(false);
  }
}, [messages]);

// ä½†å‘é€æ¶ˆæ¯æ—¶å·²ç»æ¸²æŸ“äº†ä¸€æ¬¡ï¼Œæ˜¾ç¤ºäº†æ—§çŠ¶æ€
```

#### è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ Ref å®ç°ç«‹å³æ¸…ç†

```tsx
// 1. çˆ¶ç»„ä»¶åˆ›å»º ref
const clearReportStatesRef = useRef<(() => void) | null>(null);

// 2. å­ç»„ä»¶æ³¨å†Œæ¸…ç†å‡½æ•°
useEffect(() => {
  clearReportStatesRef.current = () => {
    setGeneratedReport(null);
    setIsGeneratingReport(false);
    setReportCompleted(false);
  };
}, []);

// 3. å‘é€æ¶ˆæ¯å‰ç«‹å³è°ƒç”¨
const handleSend = () => {
  clearReportStatesRef.current?.(); // â­ åŒæ­¥æ¸…ç†
  sendMessage(content, tags);
};
```

**å…³é”®ç‚¹**ï¼š
- `useEffect` æ˜¯å¼‚æ­¥çš„ï¼ˆæ¸²æŸ“åæ‰§è¡Œï¼‰
- `ref.current()` æ˜¯åŒæ­¥çš„ï¼ˆç«‹å³æ‰§è¡Œï¼‰
- ç”¨ ref ç¡®ä¿çŠ¶æ€åœ¨æ¸²æŸ“å‰å°±è¢«æ¸…ç†

### 5.4 N8N Response Body Stream åªèƒ½è¯»å–ä¸€æ¬¡

#### é—®é¢˜æè¿°
```javascript
const response = await fetch(url);

// ç¬¬ä¸€æ¬¡è¯»å–
const text1 = await response.text();

// ç¬¬äºŒæ¬¡è¯»å–ï¼ˆæŠ¥é”™ï¼ï¼‰
const text2 = await response.text(); // âŒ Body has already been read
```

#### åŸå› 
HTTP Response Body æ˜¯ä¸€ä¸ªæµï¼ˆStreamï¼‰ï¼Œåªèƒ½è¯»å–ä¸€æ¬¡

#### è§£å†³æ–¹æ¡ˆ
```typescript
// âŒ é”™è¯¯çš„åšæ³•
try {
  const response = await fetch(url);
  if (!response.ok) {
    const errorText = await response.text(); // è¯»å–1
    throw new Error(errorText);
  }
  const data = await response.json(); // è¯»å–2 - å¤±è´¥ï¼
} catch (error) {
  console.error(error);
}

// âœ… æ­£ç¡®çš„åšæ³•
try {
  const response = await fetch(url);
  const text = await response.text(); // åªè¯»å–ä¸€æ¬¡
  
  if (!response.ok) {
    console.error('Error:', text);
    throw new Error(text);
  }
  
  const data = JSON.parse(text); // è§£ææ–‡æœ¬
  return data;
} catch (error) {
  console.error(error);
}
```

### 5.5 é¡µé¢åˆ‡æ¢å¯¼è‡´ç­›é€‰æ¡ä»¶ä¸¢å¤±

#### é—®é¢˜æè¿°
ç”¨æˆ·åœ¨"çµæ„Ÿæœé›†"é¡µé¢ç­›é€‰åï¼Œåˆ‡æ¢åˆ°å…¶ä»–é¡µé¢ï¼Œå†å›æ¥æ—¶ç­›é€‰æ¡ä»¶é‡ç½®

#### è§£å†³æ–¹æ¡ˆï¼šæ¨¡å—çº§å˜é‡ç¼“å­˜

```tsx
// âŒ ä½¿ç”¨ useStateï¼ˆç»„ä»¶å¸è½½åä¸¢å¤±ï¼‰
const [selectedBrand, setSelectedBrand] = useState('');

// âœ… ä½¿ç”¨æ¨¡å—çº§å˜é‡ï¼ˆåº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…æŒä¹…ï¼‰
let cachedSelectedBrand = '';

const Component = () => {
  const [selectedBrand, setSelectedBrand] = useState(cachedSelectedBrand);
  
  useEffect(() => {
    // æ›´æ–°æ—¶åŒæ­¥åˆ°ç¼“å­˜
    cachedSelectedBrand = selectedBrand;
  }, [selectedBrand]);
  
  // ç»„ä»¶å¸è½½åï¼ŒcachedSelectedBrand ä»ç„¶ä¿ç•™
};
```

**ä¸ºä»€ä¹ˆä¸ç”¨ localStorageï¼Ÿ**
- ä¼šå¼•å…¥å¼‚æ­¥è¯»å†™
- éœ€è¦åºåˆ—åŒ–/ååºåˆ—åŒ–
- å¯èƒ½æœ‰å¤§å°é™åˆ¶
- ä¸éœ€è¦è·¨ä¼šè¯æŒä¹…åŒ–

---

## 6. æ€§èƒ½ä¼˜åŒ–

### 6.1 æ‡’åŠ è½½ (React.lazy)

```tsx
// è·¯ç”±çº§åˆ«æ‡’åŠ è½½
const Login = lazy(() => import('./pages/Login'));
const CarShowcase = lazy(() => import('./pages/CarShowcaseMain'));
const AIAnalysis = lazy(() => import('./pages/AIAnalysis'));

// ä½¿ç”¨ Suspense åŒ…è£¹
<Suspense fallback={<LoadingSpinner />}>
  <Routes>
    <Route path="/login" element={<Login />} />
    <Route path="/car-showcase" element={<CarShowcase />} />
  </Routes>
</Suspense>
```

**æ•ˆæœ**ï¼š
- é¦–å±åŠ è½½æ—¶é—´å‡å°‘ 40%
- åˆå§‹ bundle å¤§å°ä» 800KB é™è‡³ 300KB

### 6.2 å›¾ç‰‡ä¼˜åŒ–

#### 1. æ‡’åŠ è½½ (Intersection Observer)

```tsx
const ImageWithLazyLoad = ({ src, alt }) => {
  const [isVisible, setIsVisible] = useState(false);
  const imgRef = useRef<HTMLImageElement>(null);
  
  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setIsVisible(true);
          observer.disconnect();
        }
      },
      { rootMargin: '50px' } // æå‰50pxåŠ è½½
    );
    
    if (imgRef.current) {
      observer.observe(imgRef.current);
    }
    
    return () => observer.disconnect();
  }, []);
  
  return (
    <img
      ref={imgRef}
      src={isVisible ? src : placeholder}
      alt={alt}
    />
  );
};
```

#### 2. å“åº”å¼å›¾ç‰‡

```tsx
<img
  src={smallImage}
  srcSet={`
    ${smallImage} 300w,
    ${mediumImage} 600w,
    ${largeImage} 1200w
  `}
  sizes="(max-width: 768px) 100vw, 50vw"
/>
```

#### 3. å›¾ç‰‡é¢„åŠ è½½

```tsx
// é¢„åŠ è½½å…³é”®å›¾ç‰‡
useEffect(() => {
  const preloadImages = [
    '/assets/logo.png',
    '/assets/hero.jpg'
  ];
  
  preloadImages.forEach(src => {
    const img = new Image();
    img.src = src;
  });
}, []);
```

### 6.3 é˜²æŠ–ä¸èŠ‚æµ

```tsx
// æœç´¢è¾“å…¥é˜²æŠ–
import { useDebouncedCallback } from 'use-debounce';

const handleSearch = useDebouncedCallback(
  (keyword: string) => {
    searchCars(keyword);
  },
  500 // 500ms å»¶è¿Ÿ
);

// æ»šåŠ¨äº‹ä»¶èŠ‚æµ
import { useThrottledCallback } from 'use-debounce';

const handleScroll = useThrottledCallback(
  () => {
    console.log('Scrolled');
  },
  100 // 100ms æ‰§è¡Œä¸€æ¬¡
);
```

### 6.4 è™šæ‹Ÿæ»šåŠ¨ï¼ˆæœªå®ç°ï¼Œä½†æ¨èï¼‰

å¯¹äºå¤§é‡åˆ—è¡¨æ•°æ®ï¼Œæ¨èä½¿ç”¨ `react-window` æˆ– `react-virtualized`ï¼š

```tsx
import { FixedSizeList } from 'react-window';

<FixedSizeList
  height={600}
  itemCount={1000}
  itemSize={100}
  width="100%"
>
  {({ index, style }) => (
    <div style={style}>
      <CarCard car={cars[index]} />
    </div>
  )}
</FixedSizeList>
```

---

## 7. éƒ¨ç½²ä¸è¿ç»´

### 7.1 Vercel éƒ¨ç½²é…ç½®

#### vercel.json
```json
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ],
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        { "key": "Cache-Control", "value": "s-maxage=0" }
      ]
    }
  ]
}
```

#### ç¯å¢ƒå˜é‡
```bash
# Vercel Dashboard â†’ Settings â†’ Environment Variables
N8N_API_BASE_URL=https://lynn-cafa-system.app.n8n.cloud
DEEPSEEK_API_KEY=sk-xxxxx
```

#### è‡ªåŠ¨éƒ¨ç½²æµç¨‹
```
1. Push to GitHub (main branch)
   â†“
2. Vercel è‡ªåŠ¨æ£€æµ‹åˆ°æ›´æ–°
   â†“
3. æ‹‰å–ä»£ç å¹¶æ„å»º
   â†“
4. è¿è¡Œæµ‹è¯•ï¼ˆå¦‚æœé…ç½®ï¼‰
   â†“
5. éƒ¨ç½²åˆ° Production
   â†“
6. å‘é€é€šçŸ¥ï¼ˆSlack/Emailï¼‰
```

### 7.2 N8N éƒ¨ç½²

#### N8N Cloud ä¼˜åŠ¿
- âœ… æ— éœ€è‡ªå·±ç»´æŠ¤æœåŠ¡å™¨
- âœ… è‡ªåŠ¨å¤‡ä»½å’Œæ¢å¤
- âœ… å†…ç½®ç›‘æ§å’Œæ—¥å¿—
- âœ… 99.9% å¯ç”¨æ€§ä¿è¯

#### Workflow å¤‡ä»½ç­–ç•¥
```bash
# å®šæœŸå¯¼å‡º Workflow JSON
N8N Dashboard â†’ Workflows â†’ Export

# å­˜å‚¨åˆ° GitHub
/N8NAll/
  /N8N/
  /N8ND2/
  /N8ND3/
  ...
```

#### ç›‘æ§å‘Šè­¦
```javascript
// N8N Workflow ä¸­æ·»åŠ é”™è¯¯å¤„ç†èŠ‚ç‚¹
if (error) {
  await fetch('https://slack-webhook-url', {
    method: 'POST',
    body: JSON.stringify({
      text: `âŒ å·¥ä½œæµæ‰§è¡Œå¤±è´¥: ${error.message}`
    })
  });
}
```

### 7.3 Google Sheets æ•°æ®ç®¡ç†

#### è¡¨ç»“æ„è®¾è®¡

**users (ç”¨æˆ·è¡¨)**
```
inviteCode | userName | userID   | createdAt
-----------|----------|----------|------------
ABC123     | å¼ ä¸‰     | user_001 | 2024-11-01
```

**AIDialogues (å¯¹è¯è¡¨)**
```
dialogueID | userID   | title    | conversationHistory     | tags        | createdAt
-----------|----------|----------|-------------------------|-------------|------------
dlg_001    | user_001 | å”è®¾è®¡... | [{"role":"user",...}]  | æ”¶è—å¤¹A,B   | 2024-11-02
```

**FavoriteFolders (æ”¶è—å¤¹è¡¨)**
```
folderID  | userID   | folderName | createdAt
----------|----------|------------|------------
fld_001   | user_001 | æˆ‘çš„æ”¶è—   | 2024-11-01
```

**FavoriteItems (æ”¶è—é¡¹è¡¨)**
```
favoriteID | userID | folderID | carID | imageURL | favoriteTime
-----------|--------|----------|-------|----------|-------------
fav_001    | user_001| fld_001 | c_123 | http://...| 2024-11-02
```

#### æ•°æ®å¤‡ä»½
```bash
# å®šæœŸå¯¼å‡ºä¸º CSV
Google Sheets â†’ File â†’ Download â†’ CSV

# æˆ–ä½¿ç”¨ Google Sheets API è‡ªåŠ¨å¤‡ä»½
```

---

## 8. æœ€ä½³å®è·µæ€»ç»“

### 8.1 React å¼€å‘è§„èŒƒ

#### ç»„ä»¶æ‹†åˆ†åŸåˆ™
```
å•ä¸€èŒè´£ï¼šæ¯ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹
å¯å¤ç”¨ï¼šæå–å…¬å…±é€»è¾‘åˆ° hooks
å¯æµ‹è¯•ï¼šé¿å…å‰¯ä½œç”¨ï¼Œçº¯å‡½æ•°ä¼˜å…ˆ
å¯ç»´æŠ¤ï¼šæ¸…æ™°çš„å‘½åå’Œæ³¨é‡Š
```

#### å‘½åè§„èŒƒ
```tsx
// ç»„ä»¶ï¼šPascalCase
const UserProfile = () => {};

// Hooksï¼šuse + PascalCase
const useAuth = () => {};

// å·¥å…·å‡½æ•°ï¼šcamelCase
const formatDate = () => {};

// å¸¸é‡ï¼šUPPER_SNAKE_CASE
const API_BASE_URL = 'https://...';

// ç±»å‹ï¼šPascalCase
interface User {}
type UserRole = 'admin' | 'user';
```

#### Props ç±»å‹å®šä¹‰
```tsx
// âœ… å¥½çš„åšæ³•
interface ButtonProps {
  children: React.ReactNode;
  onClick: () => void;
  variant?: 'primary' | 'secondary';
  disabled?: boolean;
}

const Button: React.FC<ButtonProps> = ({
  children,
  onClick,
  variant = 'primary',
  disabled = false
}) => {
  // ...
};

// âŒ ä¸å¥½çš„åšæ³•
const Button = (props: any) => {
  // props ç±»å‹ä¸æ˜ç¡®
};
```

### 8.2 Git å·¥ä½œæµ

#### åˆ†æ”¯ç®¡ç†
```bash
main        # ç”Ÿäº§ç¯å¢ƒï¼Œæ°¸è¿œä¿æŒç¨³å®š
develop     # å¼€å‘ç¯å¢ƒï¼Œé›†æˆæ‰€æœ‰åŠŸèƒ½
feature/*   # åŠŸèƒ½åˆ†æ”¯
bugfix/*    # Bugä¿®å¤åˆ†æ”¯
hotfix/*    # ç´§æ€¥ä¿®å¤åˆ†æ”¯
```

#### Commit è§„èŒƒ
```bash
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
refactor: é‡æ„
perf: æ€§èƒ½ä¼˜åŒ–
test: æµ‹è¯•
chore: æ„å»º/å·¥å…·é“¾

# ç¤ºä¾‹
feat: Add AI analysis feature
fix: Fix favorite button not clickable
docs: Update README.md
```

#### ä»£ç å®¡æŸ¥è¦ç‚¹
```
âœ… åŠŸèƒ½æ˜¯å¦å®Œæ•´å®ç°
âœ… æ˜¯å¦æœ‰å•å…ƒæµ‹è¯•
âœ… ä»£ç æ˜¯å¦æ¸…æ™°æ˜“æ‡‚
âœ… æ˜¯å¦æœ‰æ€§èƒ½é—®é¢˜
âœ… æ˜¯å¦ç¬¦åˆå›¢é˜Ÿè§„èŒƒ
```

### 8.3 è°ƒè¯•æŠ€å·§

#### 1. React DevTools
```bash
# å®‰è£… Chrome æ‰©å±•
React Developer Tools

# ä½¿ç”¨æŠ€å·§
- æŸ¥çœ‹ç»„ä»¶æ ‘å’Œ Props
- è§‚å¯Ÿ State å˜åŒ–
- æ€§èƒ½åˆ†æï¼ˆProfilerï¼‰
```

#### 2. Console æ—¥å¿—
```tsx
// ç»“æ„åŒ–æ—¥å¿—
console.log('ğŸš€ [ç»„ä»¶å] äº‹ä»¶å:', data);

// åˆ†ç»„æ—¥å¿—
console.group('API è¯·æ±‚');
console.log('URL:', url);
console.log('Data:', data);
console.groupEnd();

// æ¡ä»¶æ—¥å¿—
if (process.env.NODE_ENV === 'development') {
  console.log('Debug info:', info);
}
```

#### 3. Network æŠ“åŒ…
```bash
# Chrome DevTools â†’ Network
1. æŸ¥çœ‹è¯·æ±‚å‚æ•°
2. æŸ¥çœ‹å“åº”æ•°æ®
3. åˆ†æè¯·æ±‚æ—¶é—´
4. æ£€æŸ¥è·¨åŸŸé—®é¢˜
```

#### 4. Debugger æ–­ç‚¹
```tsx
function handleClick() {
  debugger; // ä»£ç ä¼šåœ¨æ­¤æš‚åœ
  // ...
}
```

---

## 9. æœªæ¥ä¼˜åŒ–æ–¹å‘

### 9.1 åŠŸèƒ½æ‰©å±•

#### 1. å¤šäººåä½œ
```
- å›¢é˜Ÿå·¥ä½œç©ºé—´
- æ”¶è—å¤¹åˆ†äº«
- è¯„è®ºå’Œæ ‡æ³¨åŠŸèƒ½
```

#### 2. æ›´å¤š AI èƒ½åŠ›
```
- å›¾ç‰‡é£æ ¼è¿ç§»
- ç›¸ä¼¼å›¾ç‰‡æ¨è
- è‡ªåŠ¨ç”Ÿæˆè®¾è®¡PPT
```

#### 3. æ•°æ®åˆ†æ
```
- ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡
- çƒ­é—¨è½¦å‹æ’è¡Œ
- è®¾è®¡è¶‹åŠ¿æŠ¥å‘Š
```

### 9.2 æŠ€æœ¯å‡çº§

#### 1. åç«¯ç‹¬ç«‹éƒ¨ç½²
```
æ›¿ä»£æ–¹æ¡ˆï¼š
- Serverless (AWS Lambda / Vercel Functions)
- Node.js + Express
- Next.js API Routes
```

#### 2. æ•°æ®åº“è¿ç§»
```
Google Sheets â†’ PostgreSQL / MongoDB
ä¼˜åŠ¿ï¼š
- æ›´å¥½çš„æŸ¥è¯¢æ€§èƒ½
- æ”¯æŒå¤æ‚å…³ç³»
- æ›´å¼ºçš„æ•°æ®å®‰å…¨
```

#### 3. ç¼“å­˜ä¼˜åŒ–
```
- Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®
- CDN åŠ é€Ÿå›¾ç‰‡åŠ è½½
- Service Worker ç¦»çº¿æ”¯æŒ
```

### 9.3 UI/UX æ”¹è¿›

#### 1. ç§»åŠ¨ç«¯é€‚é…
```
- å“åº”å¼å¸ƒå±€å®Œå–„
- è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒ
- PWA æ”¯æŒ
```

#### 2. ä¸»é¢˜åˆ‡æ¢
```
- æš—é»‘æ¨¡å¼
- å¤šè‰²å½©ä¸»é¢˜
- ä¸ªæ€§åŒ–é…ç½®
```

#### 3. æ— éšœç¢ä¼˜åŒ–
```
- ARIA æ ‡ç­¾
- é”®ç›˜å¯¼èˆª
- å±å¹•é˜…è¯»å™¨æ”¯æŒ
```

---

## é™„å½•

### A. å¸¸ç”¨å‘½ä»¤

```bash
# å¼€å‘
npm run dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run preview      # é¢„è§ˆç”Ÿäº§æ„å»º

# Git
git add .
git commit -m "feat: xxx"
git push origin main

# N8N
n8n export:workflow --id=<id> --output=workflow.json
n8n import:workflow --input=workflow.json
```

### B. èµ„æºé“¾æ¥

- **å®˜æ–¹æ–‡æ¡£**
  - [React](https://react.dev)
  - [Vite](https://vitejs.dev)
  - [Tailwind CSS](https://tailwindcss.com)
  - [N8N](https://docs.n8n.io)

- **å­¦ä¹ èµ„æº**
  - [React Patterns](https://reactpatterns.com)
  - [JavaScript Info](https://javascript.info)
  - [Web.dev](https://web.dev)

- **è®¾è®¡èµ„æº**
  - [Figma](https://figma.com)
  - [Dribbble](https://dribbble.com)
  - [Behance](https://behance.net)

### C. å›¢é˜Ÿä¿¡æ¯

- **å¼€å‘è€…**: Qitm2333
- **GitHub**: https://github.com/Qitm2333
- **é¡¹ç›®ä»“åº“**: https://github.com/Qitm2333/car-showcase-app
- **è”ç³»æ–¹å¼**: [ä½ çš„é‚®ç®±]

---

## ç»“è¯­

è¿™ä¸ªé¡¹ç›®ä»é›¶åˆ°ä¸€çš„å¼€å‘è¿‡ç¨‹å……æ»¡æŒ‘æˆ˜ï¼Œä½†ä¹Ÿæ”¶è·äº†å®è´µçš„ç»éªŒï¼š

1. **æŠ€æœ¯é€‰å‹**ï¼šé€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ ˆæ¯”è¿½æ±‚æœ€æ–°æŠ€æœ¯æ›´é‡è¦
2. **ç”¨æˆ·ä½“éªŒ**ï¼šç»†èŠ‚å†³å®šæˆè´¥ï¼Œæ¯ä¸€ä¸ªäº¤äº’éƒ½å€¼å¾—æ‰“ç£¨
3. **é—®é¢˜è§£å†³**ï¼šé‡åˆ°é—®é¢˜ä¸è¦æ…Œï¼Œä¸€æ­¥æ­¥æ’æŸ¥ï¼Œæ€»èƒ½æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ
4. **æ–‡æ¡£å…ˆè¡Œ**ï¼šå¥½çš„æ–‡æ¡£èƒ½è®©é¡¹ç›®çš„ä»·å€¼ç¿»å€
5. **æŒç»­è¿­ä»£**ï¼šæ²¡æœ‰å®Œç¾çš„äº§å“ï¼Œåªæœ‰æŒç»­æ”¹è¿›çš„äº§å“

å¸Œæœ›è¿™ä»½æ–‡æ¡£èƒ½å¸®åŠ©åˆ°åæ¥çš„å¼€å‘è€…ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶æå‡ºæ”¹è¿›å»ºè®®ï¼ğŸš€

---

**æœ€åæ›´æ–°æ—¶é—´**: 2024å¹´11æœˆ  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**ç»´æŠ¤è€…**: Qitm2333

